{"version":3,"file":"bundle.umd.js","sources":["apollo-fetch.js"],"sourcesContent":["var __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nfunction buildWareStack(funcs, modifiedObject, resolve) {\n    var _this = this;\n    var next = function () {\n        if (funcs.length > 0) {\n            var f = funcs.shift();\n            if (f) {\n                f.apply(_this, [modifiedObject, next]);\n            }\n        }\n        else {\n            resolve(modifiedObject);\n        }\n    };\n    next();\n}\nexport function constructDefaultOptions(requestOrRequests, options) {\n    var body;\n    try {\n        body = JSON.stringify(requestOrRequests);\n    }\n    catch (e) {\n        throw new Error(\"Network request failed. Payload is not serializable: \" + e.message);\n    }\n    return __assign({ body: body, method: 'POST' }, options, { headers: __assign({ Accept: '*/*', 'Content-Type': 'application/json' }, options.headers || []) });\n}\nfunction throwHttpError(response, error) {\n    var httpError;\n    if (response && response.status >= 300) {\n        httpError = new Error(\"Network request failed with status \" + response.status + \" - \\\"\" + response.statusText + \"\\\"\");\n    }\n    else {\n        httpError = new Error(\"Network request failed to return valid JSON\");\n    }\n    httpError.response = response;\n    httpError.parseError = error;\n    throw httpError;\n}\nfunction throwBatchError(response) {\n    var httpError = new Error(\"A batched Operation of responses for \");\n    httpError.response = response;\n    throw httpError;\n}\nexport function createApolloFetch(params) {\n    if (params === void 0) { params = {}; }\n    var constructOptions = params.constructOptions, customFetch = params.customFetch;\n    var _uri = params.uri || '/graphql';\n    var middlewares = [];\n    var batchedMiddlewares = [];\n    var afterwares = [];\n    var batchedAfterwares = [];\n    var applyMiddlewares = function (requestAndOptions, batched) {\n        return new Promise(function (resolve, reject) {\n            if (batched) {\n                buildWareStack(batchedMiddlewares.slice(), requestAndOptions, resolve);\n            }\n            else {\n                buildWareStack(middlewares.slice(), requestAndOptions, resolve);\n            }\n        });\n    };\n    var applyAfterwares = function (responseObject, batched) {\n        return new Promise(function (resolve, reject) {\n            if (batched) {\n                buildWareStack(batchedAfterwares.slice(), responseObject, resolve);\n            }\n            else {\n                buildWareStack(afterwares.slice(), responseObject, resolve);\n            }\n        });\n    };\n    var apolloFetch = function (request) {\n        var options = {};\n        var parseError;\n        var batched = Array.isArray(request);\n        var requestObject = (batched\n            ? {\n                requests: request,\n                options: options,\n            }\n            : {\n                request: request,\n                options: options,\n            });\n        return applyMiddlewares(requestObject, batched)\n            .then(function (reqOpts) {\n            var construct = constructOptions || constructDefaultOptions;\n            var requestOrRequests = reqOpts.request ||\n                reqOpts.requests;\n            return construct(requestOrRequests, reqOpts.options);\n        })\n            .then(function (opts) {\n            options = __assign({}, opts);\n            return (customFetch || fetch)(_uri, options);\n        })\n            .then(function (response) {\n            return response.text().then(function (raw) {\n                try {\n                    var parsed = JSON.parse(raw);\n                    response.raw = raw;\n                    response.parsed = parsed;\n                    return response;\n                }\n                catch (e) {\n                    parseError = e;\n                    response.raw = raw;\n                    return response;\n                }\n            });\n        })\n            .then(function (response) {\n            return applyAfterwares({\n                response: response,\n                options: options,\n            }, batched);\n        })\n            .then(function (_a) {\n            var response = _a.response;\n            if (response.parsed) {\n                if (batched) {\n                    if (Array.isArray(response.parsed)) {\n                        return response.parsed;\n                    }\n                    else {\n                        throwBatchError(response);\n                    }\n                }\n                else {\n                    return __assign({}, response.parsed);\n                }\n            }\n            else {\n                throwHttpError(response, parseError);\n            }\n        });\n    };\n    apolloFetch.use = function (middleware) {\n        if (typeof middleware === 'function') {\n            middlewares.push(middleware);\n        }\n        else {\n            throw new Error('Middleware must be a function');\n        }\n        return apolloFetch;\n    };\n    apolloFetch.useAfter = function (afterware) {\n        if (typeof afterware === 'function') {\n            afterwares.push(afterware);\n        }\n        else {\n            throw new Error('Afterware must be a function');\n        }\n        return apolloFetch;\n    };\n    apolloFetch.batchUse = function (middleware) {\n        if (typeof middleware === 'function') {\n            batchedMiddlewares.push(middleware);\n        }\n        else {\n            throw new Error('Middleware must be a function');\n        }\n        return apolloFetch;\n    };\n    apolloFetch.batchUseAfter = function (afterware) {\n        if (typeof afterware === 'function') {\n            batchedAfterwares.push(afterware);\n        }\n        else {\n            throw new Error('Afterware must be a function');\n        }\n        return apolloFetch;\n    };\n    return apolloFetch;\n}\n//# sourceMappingURL=apollo-fetch.js.map"],"names":["this"],"mappings":"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"}